<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Email</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
</head>
<body>
  <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è</h2>
  <input type="email" id="email" placeholder="–í–≤–µ–¥—ñ—Ç—å email">
  <button onclick="sendLoginLink()">–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –≤—Ö–æ–¥—É</button>

  <div id="status"></div>

<script>
  // üîπ –¢–≤–æ—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Firebase (–∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ —Å–≤–æ—é –∑ –∫–æ–Ω—Å–æ–ª—ñ Firebase)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    appId: "YOUR_APP_ID"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // üîπ –ù–∞–¥—Å–∏–ª–∞—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ email
  function sendLoginLink() {
    const email = document.getElementById("email").value;
    const actionCodeSettings = {
      url: window.location.href, // –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É –ø–æ–≤–µ—Ä–Ω–µ –Ω–∞ —Ü—é –∂ —Å—Ç–æ—Ä—ñ–Ω–∫—É
      handleCodeInApp: true
    };

    auth.sendSignInLinkToEmail(email, actionCodeSettings)
      .then(() => {
        document.getElementById("status").innerText =
          "–ü–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –≤—Ö–æ–¥—É –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –Ω–∞ " + email;
        window.localStorage.setItem("emailForSignIn", email);
      })
      .catch(error => {
        document.getElementById("status").innerText = error.message;
      });
  }

  // üîπ –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–∫—Ä–∏–≤ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑ email
  if (auth.isSignInWithEmailLink(window.location.href)) {
    let email = window.localStorage.getItem("emailForSignIn");
    if (!email) {
      email = window.prompt("–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É email-–∞–¥—Ä–µ—Å—É:");
    }
    auth.signInWithEmailLink(email, window.location.href)
      .then(result => {
        document.getElementById("status").innerText =
          "–í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π! –ü—Ä–∏–≤—ñ—Ç, " + result.user.email;
        window.localStorage.removeItem("emailForSignIn");
        // üîπ –¢—É—Ç –º–æ–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç–∏ –∫–∞—Ä—Ç—É –∑–∞–º—ñ—Å—Ç—å —Ñ–æ—Ä–º–∏
      })
      .catch(error => {
        document.getElementById("status").innerText = error.message;
      });
  }
</script>
</body>
</html>
